!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}}var r=new(function(){var r;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.board=e,this.score=0,this.status="idle"}return r=[{key:"getState",value:function(){return this.board}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.resetBoard(),this.addRandomTile(),this.addRandomTile(),this.status="playing"}},{key:"restart",value:function(){this.start()}},{key:"moveLeft",value:function(){this.move(function(e){return e},function(e){return e})}},{key:"moveRight",value:function(){this.move(function(e){return e.reverse()},function(e){return e.reverse()})}},{key:"moveUp",value:function(){this.moveTranspose(function(e){return e},function(e){return e})}},{key:"moveDown",value:function(){this.moveTranspose(function(e){return e.reverse()},function(e){return e.reverse()})}},{key:"resetBoard",value:function(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0}},{key:"addRandomTile",value:function(){var e=[];if(this.board.forEach(function(t,r){t.forEach(function(t,n){0===t&&e.push([r,n])})}),e.length>0){var r,n=function(e){if(Array.isArray(e))return e}(r=e[Math.floor(Math.random()*e.length)])||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],s=!0,i=!1;try{for(o=o.call(e);!(s=(r=o.next()).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){i=!0,n=e}finally{try{s||null==o.return||o.return()}finally{if(i)throw n}}return a}}(r,2)||t(r,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=n[0],a=n[1];this.board[o][a]=.9>Math.random()?2:4}}},{key:"move",value:function(r,n){var o=this,a=!1,s=this.board.map(function(s,i){var u=r(function(t){if(Array.isArray(t))return e(t)}(s)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(s)||t(s)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=o.mergeRow(u);return o.rowsEqual(u,c)||(a=!0),n(c)});a&&(this.board=s,this.addRandomTile()),this.updateStatus()}},{key:"moveTranspose",value:function(e,t){this.board=this.transpose(this.board),this.move(e,t),this.board=this.transpose(this.board)}},{key:"mergeRow",value:function(e){for(var t=[],r=!1,n=0;n<e.length;n++){if(r){r=!1;continue}0!==e[n]&&e[n]===e[n+1]?(t.push(2*e[n]),this.score+=2*e[n],r=!0):0!==e[n]&&t.push(e[n])}for(;t.length<4;)t.push(0);return t}},{key:"transpose",value:function(e){return e[0].map(function(t,r){return e.map(function(e){return e[r]})})}},{key:"rowsEqual",value:function(e,t){return e.every(function(e,r){return e===t[r]})}},{key:"updateStatus",value:function(){this.board.flat().includes(2048)?this.status="win":this.board.flat().includes(0)||this.canMakeMove()||(this.status="lose")}},{key:"canMakeMove",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)if(e>0&&this.board[e][t]===this.board[e-1][t]||t>0&&this.board[e][t]===this.board[e][t-1])return!0;return!1}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(n.prototype,r),n}());function n(){var e=r.getState(),t=document.querySelectorAll(".field-cell");e.flat().forEach(function(e,r){var n=t[r];n.textContent=e||"",n.className="field-cell",e&&n.classList.add("field-cell--".concat(e))}),document.querySelector(".game-score").textContent=r.getScore(),"win"===r.getStatus()?(document.querySelector(".message-win").classList.remove("hidden"),document.querySelector(".message-lose").classList.add("hidden")):"lose"===r.getStatus()?(document.querySelector(".message-lose").classList.remove("hidden"),document.querySelector(".message-win").classList.add("hidden")):(document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden"))}document.querySelector(".start").addEventListener("click",function(){var e=document.querySelector(".start")||document.querySelector(".restart");"playing"!==r.getStatus()?r.start():r.restart(),e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"),document.querySelector(".message-start").classList.add("hidden"),n()}),document.addEventListener("keydown",function(e){if("playing"===r.getStatus()){switch(e.key){case"ArrowLeft":r.moveLeft();break;case"ArrowRight":r.moveRight();break;case"ArrowUp":r.moveUp();break;case"ArrowDown":r.moveDown();break;default:return}n()}}),n()}();
//# sourceMappingURL=index.85e51d8b.js.map
